
         <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ ØªÙ†Ø¨ÙŠÙ‡</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html { margin: 0; padding: 0; height: 100%; font-family: sans-serif; }
        #map { height: 100vh; width: 100%; }
        .info-panel {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            z-index: 1000; background: white; padding: 10px 20px;
            border-radius: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-align: center; border: 2px solid #28a745;
        }
    </style>
</head>
<body>

    <div class="info-panel">
        ğŸ“¢ Ø§Ù„Ø­Ø§Ù„Ø©: <span id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØªØ¨Ø¹...</span><br>
        ğŸ•’ Ø¢Ø®Ø± Ø­Ø±ÙƒØ©: <span id="lastUpdate">--:--</span>
    </div>

    <div id="map"></div>

    <audio id="alertSound" src="https://www.soundjay.com/buttons/beep-07a.mp3"></audio>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const firebaseURL = "https://safehome-fd30f-default-rtdb.firebaseio.com/students/student_1.json";
        var map = L.map('map').setView([32.02, 36.08], 15);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        var studentIcon = L.icon({
            iconUrl: 'https://cdn-icons-png.flaticon.com/512/5777/5777095.png',
            iconSize: [45, 45], iconAnchor: [22, 45]
        });

        var marker = L.marker([0, 0], {icon: studentIcon}).addTo(map);
        var lastCoords = ""; // Ù„ØªØ®Ø²ÙŠÙ† Ø¢Ø®Ø± Ù…ÙˆÙ‚Ø¹ ÙˆÙ…Ù‚Ø§Ø±Ù†ØªÙ‡

        function updateMap() {
            fetch(firebaseURL)
            .then(response => response.json())
            .then(data => {
                if (data && data.lat) {
                    var currentCoords = data.lat + "," + data.lng;
                    
                    // Ø¥Ø°Ø§ ØªØºÙŠØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù† Ø¢Ø®Ø± Ù…Ø±Ø©
                    if (currentCoords !== lastCoords) {
                        lastCoords = currentCoords;
                        
                        var newPos = [data.lat, data.lng];
                        marker.setLatLng(newPos);
                        map.panTo(newPos);
                        
                        document.getElementById('lastUpdate').innerText = data.time;
                        document.getElementById('status').innerText = "ØªÙ… Ø±ØµØ¯ Ø­Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©!";
                        document.getElementById('status').style.color = "green";

                        // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
                        document.getElementById('alertSound').play().catch(e => console.log("Ø§Ù„ØµÙˆØª ÙŠØ­ØªØ§Ø¬ Ø¶ØºØ·Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ØªÙØ¹ÙŠÙ„Ù‡"));
                        
                        setTimeout(() => { document.getElementById('status').innerText = "Ù…Ø±Ø§Ù‚Ø¨"; }, 2000);
                    }
                }
            });
        }

        // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù„Ø±ØµØ¯ Ø£ÙŠ Ø­Ø±ÙƒØ© ÙÙˆØ±ÙŠØ©
        setInterval(updateMap, 1000);
    </script>
</body>
</html>
   
